<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="postTitle">í¬ìŠ¤íŠ¸ - ìš°ì£¼ì—¬í–‰ì‚¬ Blog</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Prism.js í…Œë§ˆ (Tomorrow Night) -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    
    <!-- marked.js -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <!-- Prism.js ì½”ì–´ + ì–¸ì–´ ì§€ì› -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-c.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-cpp.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-typescript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-css.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-markdown.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-odin.min.js"></script>
    
    <!-- Prism.js í”ŒëŸ¬ê·¸ì¸ -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
</head>
<body>
    <!-- í—¤ë” -->
    <header class="header">
        <nav class="navbar">
            <div class="container">
                <div class="nav-brand">
                    <a href="index.html">ìš°ì£¼ì—¬í–‰ì‚¬ Blog</a>
                </div>
                <ul class="nav-menu" id="navMenu">
                </ul>
                <div class="nav-actions">
                    <button class="theme-toggle" id="themeToggle" aria-label="ë‹¤í¬ ëª¨ë“œ í† ê¸€">
                        <span class="theme-icon">ğŸŒ™</span>
                    </button>
                    <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="ë©”ë‰´ í† ê¸€">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                </div>
            </div>
        </nav>
    </header>

    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <main class="main-content">
        <div class="container">
            <article class="post-detail">
                <div class="post-header">
                    <div class="post-meta">
                        <span class="post-date" id="postDate"></span>
                        <span class="post-category" id="postCategory"></span>
                    </div>
                    <h1 class="post-title" id="postTitleHeader"></h1>
                </div>
                <div class="post-body" id="postBody">
                    <div class="loading-message">í¬ìŠ¤íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
                </div>
                <div class="post-footer">
                    <a href="index.html" class="back-to-list">â† ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
                </div>
            </article>
        </div>
    </main>

    <!-- í‘¸í„° -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>ìš°ì£¼ì—¬í–‰ì‚¬ Blog</h4>
                    <p>ê°œë°œë§Œí•˜ëŠ” ë¸”ë¡œê·¸ì…ë‹ˆë‹¤.</p>
                </div>
                <div class="footer-section">
                    <h4>ì†Œì…œ ë¯¸ë””ì–´</h4>
                    <div class="social-links">
                        <a href="https://github.com/SpaceTravelCompany" aria-label="GitHub">GitHub</a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 SpaceTravelCompany Blog. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- ê³µí†µ ìŠ¤í¬ë¦½íŠ¸ -->
    <script src="common.js"></script>
    
    <!-- í¬ìŠ¤íŠ¸ í˜ì´ì§€ ì „ìš© ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
        // URLì—ì„œ í¬ìŠ¤íŠ¸ ID ê°€ì ¸ì˜¤ê¸°
        const urlParams = new URLSearchParams(window.location.search);
        const postId = urlParams.get('id');

        // marked ì„¤ì • (ì½”ë“œ í•˜ì´ë¼ì´íŒ…ì€ ë Œë”ë§ í›„ Prism.highlightAll()ë¡œ ì²˜ë¦¬)

        // posts.jsonì—ì„œ ì¹´í…Œê³ ë¦¬, ë‚ ì§œ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        async function getPostMeta(id) {
            try {
                const response = await fetch('posts/posts.json');
                if (!response.ok) return { category: 'ê¸°íƒ€', date: '' };
                
                const data = await response.json();
                const categoryPosts = data.find(item => item.category_posts)?.category_posts || [];
                
                for (const cat of categoryPosts) {
                    const post = cat.posts.find(p => p.id === id);
                    if (post) {
                        return { category: cat.category, date: post.date || '' };
                    }
                }
                return { category: 'ê¸°íƒ€', date: '' };
            } catch (error) {
                return { category: 'ê¸°íƒ€', date: '' };
            }
        }

        // í¬ìŠ¤íŠ¸ ë¡œë“œ
        async function loadPost() {
            if (!postId) {
                document.getElementById('postBody').innerHTML = '<p>í¬ìŠ¤íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }

            try {
                // í¬ìŠ¤íŠ¸ ë‚´ìš©ê³¼ ë©”íƒ€ì •ë³´ ë™ì‹œ ë¡œë“œ
                const [mdResponse, postMeta] = await Promise.all([
                    fetch(`posts/${postId}.md`),
                    getPostMeta(postId)
                ]);
                
                if (!mdResponse.ok) {
                    throw new Error('í¬ìŠ¤íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }

                const content = await mdResponse.text();
                const { metadata, body } = parseFrontmatter(content);

                // ë©”íƒ€ë°ì´í„° í‘œì‹œ
                document.getElementById('postDate').textContent = postMeta.date;
                document.getElementById('postCategory').textContent = postMeta.category;
                document.getElementById('postTitleHeader').textContent = metadata.title || 'ì œëª© ì—†ìŒ';
                document.title = `${metadata.title || 'í¬ìŠ¤íŠ¸'} - ìš°ì£¼ì—¬í–‰ì‚¬ Blog`;

                // ë§ˆí¬ë‹¤ìš´ ë³¸ë¬¸ì„ HTMLë¡œ ë³€í™˜
                document.getElementById('postBody').innerHTML = marked.parse(body);
                
                // Prism.jsë¡œ ì½”ë“œ í•˜ì´ë¼ì´íŒ… ì ìš©
                Prism.highlightAll();
            } catch (error) {
                console.error('í¬ìŠ¤íŠ¸ ë¡œë“œ ì˜¤ë¥˜:', error);
                document.getElementById('postBody').innerHTML = '<p>í¬ìŠ¤íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>';
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ í¬ìŠ¤íŠ¸ ë¡œë“œ
        window.addEventListener('DOMContentLoaded', loadPost);
    </script>
</body>
</html>
